<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Sleep Tracker Pro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #0a0a1a 0%, #1a1a2e 50%, #16213e 100%);
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            font-weight: 400;
            line-height: 1.7;
            letter-spacing: 0.01em;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            /* iPhone X safe area support */
            padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
            margin: 0;
            width: 100%;
        }

        
        /* Subtle animated background elements */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            opacity: 0.3;
        }
        
        .floating-shape {
            position: absolute;
            border-radius: 50%;
            background: linear-gradient(45deg, rgba(74, 144, 226, 0.1), rgba(138, 43, 226, 0.1));
            animation: subtleFloat 20s ease-in-out infinite;
            filter: blur(1px);
        }
        
        @keyframes subtleFloat {
            0%, 100% { transform: translateY(0px) scale(1); opacity: 0.2; }
            50% { transform: translateY(-30px) scale(1.1); opacity: 0.4; }
        }
        
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            opacity: 0.6;
        }
        
        .star {
            position: absolute;
            background: #ffffff;
            border-radius: 50%;
            opacity: 0.8;
            animation: gentleTwinkle 4s infinite ease-in-out;
            box-shadow: 0 0 4px rgba(255, 255, 255, 0.5);
        }
        
        @keyframes gentleTwinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.2); }
        }
        
        /* Professional Navigation */
        .nav-container {
            position: fixed;
            bottom: max(24px, env(safe-area-inset-bottom) + 8px);
            left: 50%;
            transform: translateX(-50%);
            background: rgba(15, 15, 35, 0.98);
            backdrop-filter: blur(30px) saturate(1.3);
            border-radius: 28px;
            padding: 16px 20px max(16px, env(safe-area-inset-bottom) + 4px) 20px;
            border: 1px solid rgba(74, 144, 226, 0.25);
            z-index: 1000;
            box-shadow: 
                0 16px 48px rgba(0, 0, 0, 0.4),
                0 4px 16px rgba(74, 144, 226, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            width: calc(100% - 32px);
            max-width: 400px;
        }
        
        .nav-menu {
            display: flex;
            gap: 20px;
            align-items: center;
            justify-content: space-around;
            width: 100%;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            padding: 12px 8px;
            border-radius: 16px;
            min-width: 56px;
            position: relative;
            flex: 1;
            max-width: 64px;
        }
        
        .nav-item:hover {
            background: rgba(74, 144, 226, 0.15);
            transform: translateY(-3px);
        }
        
        .nav-item.active {
            background: linear-gradient(135deg, rgba(74, 144, 226, 0.25), rgba(138, 43, 226, 0.2));
            color: #ffffff;
            box-shadow: 
                0 8px 24px rgba(74, 144, 226, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }
        
        .nav-icon {
            font-size: 24px;
            margin-bottom: 4px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
        }
        
        .nav-item:hover .nav-icon {
            transform: scale(1.1);
        }
        
        .nav-label {
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            opacity: 0.9;
            text-align: center;
            line-height: 1;
        }
        
        /* Main container */
        .container {
            max-width: 100%;
            width: 100%;
            margin: 0 auto;
            padding: max(20px, env(safe-area-inset-top) + 10px) 16px max(100px, env(safe-area-inset-bottom) + 80px) 16px;
            position: relative;
            z-index: 2;
            box-sizing: border-box;
        }
        
        /* Page sections */
        .page {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        .page.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Header styles */
        .page-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px 0 10px;
        }
        
        .page-title {
            font-size: 36px;
            font-weight: 800;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #4a90e2 0%, #667eea 50%, #8a2be2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.5px;
            text-align: center;
            line-height: 1.1;
            text-shadow: 0 0 30px rgba(74, 144, 226, 0.3);
        }
        
        .page-subtitle {
            font-size: 16px;
            color: #b8c5d1;
            margin-bottom: 30px;
            text-align: center;
            font-weight: 500;
            letter-spacing: 0.3px;
            opacity: 0.9;
        }
        
        /* Professional Card Design */
        .card {
            background: rgba(25, 32, 48, 0.95);
            backdrop-filter: blur(25px) saturate(1.3);
            border-radius: 20px;
            padding: 24px 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(74, 144, 226, 0.2);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.2),
                0 2px 8px rgba(74, 144, 226, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }
        
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 
                0 16px 48px rgba(0, 0, 0, 0.25),
                0 4px 16px rgba(74, 144, 226, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
            border-color: rgba(74, 144, 226, 0.4);
        }


        
        /* Stats grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, rgba(74, 144, 226, 0.15), rgba(138, 43, 226, 0.1));
            border: 1px solid rgba(74, 144, 226, 0.3);
            border-radius: 16px;
            padding: 20px 16px;
            text-align: center;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            backdrop-filter: blur(15px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }
        
        .stat-card:hover {
            transform: translateY(-4px) scale(1.01);
            box-shadow: 
                0 12px 32px rgba(74, 144, 226, 0.2),
                0 4px 16px rgba(0, 0, 0, 0.15);
            border-color: rgba(74, 144, 226, 0.5);
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 800;
            color: #4a90e2;
            display: block;
            margin-bottom: 6px;
            text-shadow: 0 2px 8px rgba(74, 144, 226, 0.3);
            line-height: 1;
        }
        
        .stat-label {
            font-size: 12px;
            color: #b8c5d1;
            margin-top: 6px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            opacity: 0.9;
        }
        
        /* Professional Buttons */
        .btn-primary {
            background: linear-gradient(135deg, #4a90e2 0%, #667eea 50%, #8a2be2 100%);
            border: none;
            border-radius: 20px;
            padding: 20px 32px;
            width: 100%;
            cursor: pointer;
            text-align: center;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 17px;
            font-weight: 700;
            color: white;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 8px 24px rgba(74, 144, 226, 0.4),
                0 2px 8px rgba(0, 0, 0, 0.1);
            letter-spacing: 0.5px;
            text-transform: uppercase;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 
                0 16px 40px rgba(74, 144, 226, 0.5),
                0 4px 16px rgba(0, 0, 0, 0.15);
        }
        
        .btn-primary:hover::before {
            left: 100%;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            border: none;
            border-radius: 18px;
            padding: 18px 24px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 16px;
            font-weight: 700;
            color: white;
            width: 100%;
            box-shadow: 
                0 6px 20px rgba(231, 76, 60, 0.4),
                0 2px 8px rgba(0, 0, 0, 0.1);
            letter-spacing: 0.3px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .btn-secondary:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 
                0 12px 32px rgba(231, 76, 60, 0.5),
                0 4px 16px rgba(0, 0, 0, 0.15);
        }
        
        /* Tracking interface */
        .tracking-interface {
            text-align: center;
            padding: 36px 24px;
            background: linear-gradient(135deg, rgba(22, 33, 62, 0.95), rgba(25, 32, 48, 0.9));
            border-radius: 24px;
            border: 2px solid rgba(74, 144, 226, 0.3);
            backdrop-filter: blur(20px);
            position: relative;
            overflow: hidden;
            margin-bottom: 24px;
            box-shadow: 
                0 12px 40px rgba(0, 0, 0, 0.2),
                0 4px 16px rgba(74, 144, 226, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }
        
        .tracking-interface::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(74, 144, 226, 0.08), transparent);
            animation: pulse 4s infinite ease-in-out;
        }
        
        @keyframes pulse {
            0% { transform: rotate(0deg); opacity: 0.5; }
            50% { transform: rotate(180deg); opacity: 0.8; }
            100% { transform: rotate(360deg); opacity: 0.5; }
        }
        
        .live-timer {
            font-size: 44px;
            font-weight: 900;
            color: #4a90e2;
            margin: 20px 0;
            font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', monospace;
            position: relative;
            z-index: 1;
            text-shadow: 
                0 0 30px rgba(74, 144, 226, 0.6),
                0 4px 8px rgba(0, 0, 0, 0.3);
            letter-spacing: 1px;
        }
        
        .tracking-status {
            font-size: 18px;
            color: #b8c5d1;
            margin: 16px 0;
            position: relative;
            z-index: 1;
            font-weight: 600;
            letter-spacing: 0.3px;
        }
        
        /* Progress elements */
        .progress-container {
            margin: 25px 0;
        }
        
        .progress-bar {
            background: rgba(70, 144, 226, 0.2);
            border-radius: 15px;
            height: 25px;
            overflow: hidden;
            position: relative;
        }
        
        .progress-fill {
            background: linear-gradient(90deg, #4a90e2, #7b68ee);
            height: 100%;
            border-radius: 15px;
            transition: width 0.8s ease;
            position: relative;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .progress-text {
            text-align: center;
            margin-top: 10px;
            color: #a0a0a0;
            font-size: 14px;
        }
        
        /* Form elements */
        .form-group {
            margin: 24px 0;
        }
        
        .form-label {
            display: block;
            margin-bottom: 12px;
            color: #b8c5d1;
            font-weight: 600;
            font-size: 15px;
            letter-spacing: 0.5px;
        }
        
        .form-input {
            width: 100%;
            background: linear-gradient(135deg, rgba(74, 144, 226, 0.12), rgba(138, 43, 226, 0.08));
            border: 2px solid rgba(74, 144, 226, 0.3);
            border-radius: 16px;
            padding: 18px 20px;
            color: white;
            font-size: 16px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(10px);
            font-weight: 500;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #4a90e2;
            box-shadow: 
                0 0 0 4px rgba(74, 144, 226, 0.2),
                0 4px 16px rgba(74, 144, 226, 0.3);
            background: linear-gradient(135deg, rgba(74, 144, 226, 0.18), rgba(138, 43, 226, 0.12));
            transform: translateY(-2px);
        }
        
        .form-input::placeholder {
            color: rgba(184, 197, 209, 0.6);
            font-weight: 500;
        }
        
        .form-row {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .form-row .form-input {
            width: 80px;
            text-align: center;
        }
        
        /* Quality selector */
        .quality-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 24px 0;
        }
        
        .quality-option {
            padding: 20px;
            border: 2px solid rgba(74, 144, 226, 0.3);
            border-radius: 20px;
            background: linear-gradient(135deg, rgba(74, 144, 226, 0.12), rgba(138, 43, 226, 0.08));
            color: white;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: center;
            font-weight: 700;
            font-size: 16px;
            letter-spacing: 0.5px;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }
        
        .quality-option:hover {
            border-color: rgba(74, 144, 226, 0.6);
            background: linear-gradient(135deg, rgba(74, 144, 226, 0.2), rgba(138, 43, 226, 0.15));
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 8px 24px rgba(74, 144, 226, 0.2);
        }
        
        .quality-option.selected {
            background: linear-gradient(135deg, #4a90e2, #667eea);
            border-color: #4a90e2;
            color: white;
            box-shadow: 
                0 8px 24px rgba(74, 144, 226, 0.4),
                0 2px 8px rgba(0, 0, 0, 0.1);
            transform: scale(1.05);
        }
        
        /* Charts and visualization */
        .chart-container {
            margin: 30px 0;
        }
        
        .chart-title {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 24px;
            color: #4a90e2;
            letter-spacing: 0.5px;
            text-shadow: 0 2px 8px rgba(74, 144, 226, 0.3);
        }
        
        .bar-chart {
            display: flex;
            align-items: end;
            gap: 16px;
            height: 140px;
            margin: 24px 0;
            padding: 24px;
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.8), rgba(20, 25, 40, 0.6));
            border-radius: 20px;
            border: 1px solid rgba(74, 144, 226, 0.2);
            backdrop-filter: blur(10px);
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .bar {
            background: linear-gradient(to top, #4a90e2 0%, #667eea 50%, #8a2be2 100%);
            border-radius: 8px 8px 0 0;
            min-width: 36px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
        }
        
        .bar:hover {
            opacity: 0.9;
            transform: scaleY(1.15) scaleX(1.05);
            box-shadow: 0 8px 24px rgba(74, 144, 226, 0.4);
        }
        
        .bar::after {
            content: attr(data-label);
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 12px;
            color: #b8c5d1;
            white-space: nowrap;
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        /* List items */
        .list-item {
            background: rgba(22, 33, 62, 0.6);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid rgba(74, 144, 226, 0.2);
            transition: all 0.3s ease;
        }
        
        .list-item:hover {
            transform: translateX(5px);
            border-color: rgba(74, 144, 226, 0.4);
            box-shadow: 0 5px 20px rgba(74, 144, 226, 0.1);
        }
        
        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .item-title {
            font-weight: bold;
            font-size: 16px;
        }
        
        .item-value {
            color: #4a90e2;
            font-weight: bold;
        }
        
        .item-subtitle {
            color: #a0a0a0;
            font-size: 14px;
        }
        
        /* Contact form */
        .contact-info {
            text-align: center;
            padding: 30px;
            background: rgba(22, 33, 62, 0.6);
            border-radius: 20px;
            margin: 20px 0;
        }
        
        .contact-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
        }
        
        .contact-link {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: #4a90e2;
            transition: all 0.3s ease;
            padding: 15px;
            border-radius: 15px;
            border: 1px solid rgba(74, 144, 226, 0.3);
        }
        
        .contact-link:hover {
            background: rgba(74, 144, 226, 0.1);
            transform: translateY(-3px);
        }
        
        .contact-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }
        
        /* Quick action grid */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin: 24px 0;
        }
        
        /* Clean Action Cards */
        .action-card {
            background: linear-gradient(135deg, rgba(74, 144, 226, 0.12), rgba(138, 43, 226, 0.08));
            border: 1px solid rgba(74, 144, 226, 0.25);
            border-radius: 16px;
            padding: 20px 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            backdrop-filter: blur(15px);
            box-shadow: 
                0 4px 16px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }
        
        .action-card:hover {
            transform: translateY(-3px) scale(1.02);
            background: linear-gradient(135deg, rgba(74, 144, 226, 0.2), rgba(138, 43, 226, 0.15));
            border-color: rgba(74, 144, 226, 0.5);
            box-shadow: 
                0 12px 28px rgba(74, 144, 226, 0.2),
                0 4px 16px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }
        
        .action-icon {
            font-size: 28px;
            margin-bottom: 8px;
            display: block;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.2));
        }
        
        .action-card:hover .action-icon {
            transform: scale(1.1) translateY(-1px);
        }
        
        .action-label {
            font-size: 12px;
            font-weight: 700;
            color: #ffffff;
            text-transform: uppercase;
            letter-spacing: 0.6px;
            opacity: 0.95;
            line-height: 1.2;
        }
        
        /* Utility classes */
        .hidden {
            display: none !important;
        }
        
        .text-center {
            text-align: center;
        }
        
        .mb-20 {
            margin-bottom: 20px;
        }
        
        .mt-20 {
            margin-top: 20px;
        }
        
        /* New Feature Styles */
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .achievement-badge {
            background: linear-gradient(135deg, rgba(255, 20, 147, 0.2), rgba(138, 43, 226, 0.2));
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 2px solid rgba(255, 20, 147, 0.3);
            transition: all 0.3s ease;
        }
        
        .achievement-badge.locked {
            opacity: 0.5;
            filter: grayscale(100%);
        }
        
        .achievement-badge:not(.locked) {
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
            animation: achievementGlow 2s ease-in-out infinite;
        }
        
        @keyframes achievementGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.3); }
            50% { box-shadow: 0 0 30px rgba(255, 215, 0, 0.6); }
        }
        
        .achievement-icon {
            font-size: 32px;
            margin-bottom: 10px;
            display: block;
        }
        
        .achievement-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: #ffffff;
        }
        
        .achievement-desc {
            font-size: 12px;
            color: #a0a0a0;
        }
        
        .quality-breakdown {
            margin: 20px 0;
        }
        
        .quality-item {
            display: flex;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        
        .quality-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }
        
        .quality-emoji {
            font-size: 24px;
            margin-right: 15px;
        }
        
        .quality-text {
            flex: 1;
            color: #ffffff;
        }
        
        .quality-score {
            font-weight: bold;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            text-transform: uppercase;
        }
        
        .quality-score.excellent {
            background: linear-gradient(135deg, #00ff88, #00cc6a);
            color: #000;
        }
        
        .quality-score.good {
            background: linear-gradient(135deg, #ffd700, #ffb347);
            color: #000;
        }
        
        .quality-score.fair {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: #fff;
        }
        
        .metric-trend {
            font-size: 12px;
            margin-top: 5px;
            font-weight: bold;
        }
        
        .metric-trend.up {
            color: #00ff88;
        }
        
        .metric-trend.down {
            color: #ff6b6b;
        }
        
        .records-grid {
            display: grid;
            gap: 15px;
            margin: 20px 0;
        }
        
        .record-item {
            display: flex;
            align-items: center;
            padding: 20px;
            background: linear-gradient(135deg, rgba(255, 20, 147, 0.1), rgba(138, 43, 226, 0.1));
            border-radius: 15px;
            border: 1px solid rgba(255, 20, 147, 0.3);
            transition: all 0.3s ease;
        }
        
        .record-item:hover {
            transform: scale(1.02);
            box-shadow: 0 10px 25px rgba(255, 20, 147, 0.2);
        }
        
        .record-icon {
            font-size: 32px;
            margin-right: 15px;
        }
        
        .record-title {
            color: #a0a0a0;
            font-size: 14px;
        }
        
        .record-value {
            color: #ffffff;
            font-size: 18px;
            font-weight: bold;
        }
        
        .setting-item {
            margin: 20px 0;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        
        .setting-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .setting-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            color: #ffffff;
            font-weight: 500;
        }
        
        .setting-label input[type="checkbox"] {
            margin-right: 12px;
            transform: scale(1.2);
            accent-color: #ff1493;
        }

        /* Sleep Phases Chart */
        .sleep-phases-chart {
            margin: 20px 0;
        }

        .phase-bar {
            display: flex;
            height: 40px;
            border-radius: 20px;
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .phase-segment {
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .phase-segment:hover {
            filter: brightness(1.2);
            transform: scaleY(1.1);
        }

        .phase-segment.awake {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
        }

        .phase-segment.light {
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
        }

        .phase-segment.deep {
            background: linear-gradient(135deg, #667eea, #764ba2);
        }

        .phase-segment.rem {
            background: linear-gradient(135deg, #f093fb, #f5576c);
        }

        .phase-legend {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            font-size: 14px;
            color: #ffffff;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .legend-color.awake {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
        }

        .legend-color.light {
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
        }

        .legend-color.deep {
            background: linear-gradient(135deg, #667eea, #764ba2);
        }

        .legend-color.rem {
            background: linear-gradient(135deg, #f093fb, #f5576c);
        }

        /* Advanced Tracking Features */
        .circadian-clock {
            position: relative;
            width: 200px;
            height: 200px;
            margin: 20px auto;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.3);
        }

        .clock-face {
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            bottom: 10px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .sleep-trend-chart {
            height: 150px;
            background: rgba(15, 15, 35, 0.5);
            border-radius: 15px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
        }

        .trend-line {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #4a90e2, #8a2be2, #4a90e2);
            background-size: 200% 200%;
            animation: trendAnimation 3s ease-in-out infinite;
        }

        @keyframes trendAnimation {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* Smart Alerts */
        .smart-alert {
            background: linear-gradient(135deg, rgba(255, 152, 0, 0.1), rgba(255, 193, 7, 0.1));
            border: 1px solid rgba(255, 152, 0, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            animation: pulseAlert 2s ease-in-out infinite;
        }

        @keyframes pulseAlert {
            0%, 100% { box-shadow: 0 0 0 0 rgba(255, 152, 0, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(255, 152, 0, 0.1); }
        }

        .alert-icon {
            font-size: 24px;
            margin-right: 12px;
        }

        .alert-text {
            flex: 1;
            color: #ffffff;
            font-weight: 500;
        }

        /* Sleep Score Ring */
        .sleep-score-ring {
            position: relative;
            width: 120px;
            height: 120px;
            margin: 20px auto;
        }

        .score-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: conic-gradient(from 0deg, #4a90e2 0deg, #4a90e2 252deg, rgba(74, 144, 226, 0.2) 252deg);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .score-circle::before {
            content: '';
            position: absolute;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: rgba(20, 25, 40, 0.9);
        }

        .score-value {
            position: relative;
            z-index: 1;
            font-size: 24px;
            font-weight: bold;
            color: #4a90e2;
        }
        
        /* Responsive design */
        @media (max-width: 480px) {
            .container {
                padding: max(16px, env(safe-area-inset-top) + 8px) 12px max(90px, env(safe-area-inset-bottom) + 70px) 12px;
            }
            
            .nav-menu {
                gap: 16px;
            }
            
            .nav-item {
                min-width: 48px;
                padding: 10px 6px;
            }
            
            .nav-icon {
                font-size: 22px;
                margin-bottom: 3px;
            }
            
            .nav-label {
                font-size: 9px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .quality-options {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .live-timer {
                font-size: 36px;
                margin: 16px 0;
            }
            
            .quick-actions {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .action-card {
                padding: 16px 12px;
            }
            
            .action-icon {
                font-size: 24px;
                margin-bottom: 6px;
            }
            
            .action-label {
                font-size: 11px;
                letter-spacing: 0.4px;
            }
            
            .page-title {
                font-size: 28px;
            }
            
            .page-subtitle {
                font-size: 14px;
            }
            
            .card {
                padding: 20px 16px;
                margin-bottom: 16px;
            }
            
            .tracking-interface {
                padding: 28px 20px;
            }
            
            .chart-title {
                font-size: 20px;
            }
            
            .bar-chart {
                height: 120px;
                padding: 20px;
            }
            
            .form-input {
                padding: 16px 18px;
            }
            
            .btn-primary {
                padding: 18px 28px;
                font-size: 16px;
            }
        }
        
        /* iPhone X specific optimizations */
        @media only screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) {
            .nav-container {
                bottom: max(16px, env(safe-area-inset-bottom) + 4px);
                width: calc(100% - 24px);
                max-width: 350px;
            }
            
            .container {
                max-width: 100%;
                padding: max(44px, env(safe-area-inset-top)) 16px max(90px, env(safe-area-inset-bottom) + 74px) 16px;
            }
        }
        
        /* Handle landscape orientation on iPhone X */
        @media only screen and (orientation: landscape) and (max-height: 450px) {
            .page-header {
                margin-bottom: 20px;
                padding: 10px 0;
            }
            
            .page-title {
                font-size: 24px;
                margin-bottom: 4px;
            }
            
            .page-subtitle {
                font-size: 12px;
                margin-bottom: 16px;
            }
            
            .tracking-interface {
                padding: 20px 16px;
            }
            
            .live-timer {
                font-size: 32px;
                margin: 12px 0;
            }
            
            .card {
                padding: 16px;
                margin-bottom: 12px;
            }
            
            .nav-container {
                bottom: max(8px, env(safe-area-inset-bottom) + 2px);
                padding: 12px 16px;
            }
            
            .nav-item {
                padding: 8px 4px;
            }
            
            .nav-icon {
                font-size: 20px;
            }
            
            .nav-label {
                font-size: 8px;
            }
        }
    </style>
</head>
<body>
    <!-- Animated background -->
    <div class="bg-animation">
        <div class="stars" id="stars"></div>
    </div>

    <!-- Main container -->
    <div class="container">
        <!-- Home Page -->
        <div id="homePage" class="page active">
            <div class="page-header">
                <h1 class="page-title">Sleep Tracker Pro</h1>
                <p class="page-subtitle">Your gateway to better sleep</p>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <span class="stat-value" id="avgSleepDisplay">7.5h</span>
                    <span class="stat-label">Avg Sleep</span>
                </div>
                <div class="stat-card">
                    <span class="stat-value" id="totalSessionsDisplay">0</span>
                    <span class="stat-label">Sessions</span>
                </div>
                <div class="stat-card">
                    <span class="stat-value" id="streakDisplay">0</span>
                    <span class="stat-label">Streak</span>
                </div>
                <div class="stat-card">
                    <span class="stat-value" id="goalProgressDisplay">0%</span>
                    <span class="stat-label">Goal</span>
                </div>
            </div>
            
            <div class="card">
                <h3 class="chart-title">Weekly Sleep Pattern</h3>
                <div class="bar-chart" id="weeklyChart"></div>
            </div>
            
            <div class="card">
                <h3 style="margin-bottom: 20px; color: #4a90e2; font-weight: 600;">Quick Actions</h3>
                <div class="quick-actions">
                    <div class="action-card" onclick="playClickSound(); showPage('sleepPage')">
                        <div class="action-icon">üõèÔ∏è</div>
                        <div class="action-label">Start Sleep</div>
                    </div>
                    <div class="action-card" onclick="playClickSound(); showPage('analyticsPage')">
                        <div class="action-icon">üìä</div>
                        <div class="action-label">Analytics</div>
                    </div>
                    <div class="action-card" onclick="playClickSound(); showSleepEnvironment()">
                        <div class="action-icon">üåô</div>
                        <div class="action-label">Sleep Mode</div>
                    </div>
                    <div class="action-card" onclick="playClickSound(); showMeditationGuide()">
                        <div class="action-icon">üßò</div>
                        <div class="action-label">Meditation</div>
                    </div>
                    <div class="action-card" onclick="playClickSound(); showSmartAlarm()">
                        <div class="action-icon">‚è∞</div>
                        <div class="action-label">Smart Alarm</div>
                    </div>
                    <div class="action-card" onclick="playClickSound(); showSleepStories()">
                        <div class="action-icon">üìñ</div>
                        <div class="action-label">Sleep Stories</div>
                    </div>
                    <div class="action-card" onclick="playClickSound(); showAICoach()">
                        <div class="action-icon">ü§ñ</div>
                        <div class="action-label">AI Coach</div>
                    </div>
                    <div class="action-card" onclick="playClickSound(); showSleepLab()">
                        <div class="action-icon">üî¨</div>
                        <div class="action-label">Sleep Lab</div>
                    </div>
                    <div class="action-card" onclick="playClickSound(); showBiometrics()">
                        <div class="action-icon">üíì</div>
                        <div class="action-label">Biometrics</div>
                    </div>
                    <div class="action-card" onclick="playClickSound(); showDreamJournal()">
                        <div class="action-icon">üí≠</div>
                        <div class="action-label">Dream Journal</div>
                    </div>
                    <div class="action-card" onclick="playClickSound(); showSleepHypnosis()">
                        <div class="action-icon">üåÄ</div>
                        <div class="action-label">Hypnosis</div>
                    </div>
                    <div class="action-card" onclick="playClickSound(); showPerformanceMode()">
                        <div class="action-icon">‚ö°</div>
                        <div class="action-label">Performance</div>
                    </div>
                    <div class="action-card" onclick="playClickSound(); showSleepAnalyzer()">
                        <div class="action-icon">üß†</div>
                        <div class="action-label">Sleep Analyzer</div>
                    </div>
                    <div class="action-card" onclick="playClickSound(); showCircadianTracker()">
                        <div class="action-icon">üåÖ</div>
                        <div class="action-label">Circadian</div>
                    </div>
                    <div class="action-card" onclick="playClickSound(); showSleepDebtTracker()">
                        <div class="action-icon">‚ö†Ô∏è</div>
                        <div class="action-label">Sleep Debt</div>
                    </div>
                    <div class="action-card" onclick="playClickSound(); showEnvironmentMonitor()">
                        <div class="action-icon">üå°Ô∏è</div>
                        <div class="action-label">Environment</div>
                    </div>
                </div>
            </div>
            
            <div class="card" id="insightsCard">
                <h3 style="margin-bottom: 15px; color: #4a90e2;">üß† AI Sleep Insights</h3>
                <p id="personalizedInsight" class="item-subtitle">
                    Start tracking your sleep to receive AI-powered personalized insights about your sleep patterns.
                </p>
            </div>

            <div class="card" id="sleepRecommendationsCard">
                <h3 style="margin-bottom: 15px; color: #ff6b6b;">‚ö° Smart Recommendations</h3>
                <div id="recommendationsList">
                    <div class="quality-item">
                        <span class="quality-emoji">üåô</span>
                        <span class="quality-text">Optimal bedtime tonight: <strong>10:30 PM</strong></span>
                        <span class="quality-score good">Active</span>
                    </div>
                    <div class="quality-item">
                        <span class="quality-emoji">üì±</span>
                        <span class="quality-text">Reduce screen time 1 hour before bed</span>
                        <span class="quality-score fair">Reminder</span>
                    </div>
                    <div class="quality-item">
                        <span class="quality-emoji">üå°Ô∏è</span>
                        <span class="quality-text">Room temperature: Keep between 65-68¬∞F</span>
                        <span class="quality-score excellent">Tip</span>
                    </div>
                </div>
            </div>

            <div class="card" id="sleepDebtCard">
                <h3 style="margin-bottom: 15px; color: #e74c3c;">‚ö†Ô∏è Sleep Debt Monitor</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="stat-value" id="sleepDebtValue">-2.5h</span>
                        <span class="stat-label">Sleep Debt</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="recoveryTime">3 days</span>
                        <span class="stat-label">Recovery Time</span>
                    </div>
                </div>
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="debtProgress" style="width: 65%; background: linear-gradient(90deg, #e74c3c, #c0392b);"></div>
                    </div>
                    <div class="progress-text">Sleep debt recovery in progress</div>
                </div>
            </div>
            
            <div class="card">
                <h3 style="margin-bottom: 20px; color: #ff1493;">üèÜ Sleep Achievements</h3>
                <div id="achievementsList" class="achievements-grid">
                    <div class="achievement-badge locked">
                        <div class="achievement-icon">üåü</div>
                        <div class="achievement-title">First Night</div>
                        <div class="achievement-desc">Complete your first sleep session</div>
                    </div>
                    <div class="achievement-badge locked">
                        <div class="achievement-icon">üî•</div>
                        <div class="achievement-title">Week Warrior</div>
                        <div class="achievement-desc">7 days in a row</div>
                    </div>
                    <div class="achievement-badge locked">
                        <div class="achievement-icon">üíé</div>
                        <div class="achievement-title">Sleep Master</div>
                        <div class="achievement-desc">Perfect sleep quality 5 times</div>
                    </div>
                    <div class="achievement-badge locked">
                        <div class="achievement-icon">‚ö°</div>
                        <div class="achievement-title">Early Bird</div>
                        <div class="achievement-desc">Wake up before 6 AM</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sleep Tracking Page -->
        <div id="sleepPage" class="page">
            <div class="page-header">
                <h1 class="page-title">Sleep Tracking</h1>
                <p class="page-subtitle">Monitor your sleep journey</p>
            </div>
            
            <div class="tracking-interface">
                <div class="tracking-status" id="trackingStatus">Ready to track your sleep</div>
                <div class="live-timer" id="liveTimer">00:00:00</div>
                <button class="btn-primary" id="toggleTrackingBtn" onclick="toggleTracking()">
                    üåô Start Sleep Tracking
                </button>
            </div>
            
            <div class="card">
                <h3 style="margin-bottom: 20px; color: #4a90e2;">Sleep Quality Rating</h3>
                <div class="quality-options">
                    <div class="quality-option" onclick="selectQuality('poor')">
                        üòû Poor
                    </div>
                    <div class="quality-option" onclick="selectQuality('fair')">
                        üòê Fair
                    </div>
                    <div class="quality-option" onclick="selectQuality('good')">
                        üòä Good
                    </div>
                    <div class="quality-option" onclick="selectQuality('excellent')">
                        üòÑ Excellent
                    </div>
                </div>
            </div>

            <div class="card" id="sleepPhasesCard">
                <h3 style="margin-bottom: 20px; color: #8a2be2;">üåô Sleep Phases Analysis</h3>
                <div class="sleep-phases-chart">
                    <div class="phase-bar">
                        <div class="phase-segment awake" style="width: 5%;" data-phase="Awake" data-duration="12min"></div>
                        <div class="phase-segment light" style="width: 45%;" data-phase="Light Sleep" data-duration="3h 24min"></div>
                        <div class="phase-segment deep" style="width: 25%;" data-phase="Deep Sleep" data-duration="1h 53min"></div>
                        <div class="phase-segment rem" style="width: 25%;" data-phase="REM Sleep" data-duration="1h 53min"></div>
                    </div>
                    <div class="phase-legend">
                        <div class="legend-item">
                            <span class="legend-color awake"></span>
                            <span>Awake (5%)</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color light"></span>
                            <span>Light Sleep (45%)</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color deep"></span>
                            <span>Deep Sleep (25%)</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color rem"></span>
                            <span>REM Sleep (25%)</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card" id="environmentCard">
                <h3 style="margin-bottom: 20px; color: #00bcd4;">üå°Ô∏è Sleep Environment</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="stat-value" id="roomTemp">68¬∞F</span>
                        <span class="stat-label">Temperature</span>
                        <div class="metric-trend up">Optimal ‚úÖ</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="humidity">45%</span>
                        <span class="stat-label">Humidity</span>
                        <div class="metric-trend up">Good ‚úÖ</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="noiseLevel">32dB</span>
                        <span class="stat-label">Noise Level</span>
                        <div class="metric-trend up">Quiet ‚úÖ</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="lightLevel">0 lux</span>
                        <span class="stat-label">Light Level</span>
                        <div class="metric-trend up">Dark ‚úÖ</div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3 style="margin-bottom: 20px; color: #4a90e2;">Recent Sleep Sessions</h3>
                <div id="recentSessions">
                    <p class="item-subtitle text-center">No sleep sessions recorded yet</p>
                </div>
            </div>
        </div>

        <!-- Goals Page -->
        <div id="goalsPage" class="page">
            <div class="page-header">
                <h1 class="page-title">Sleep Goals</h1>
                <p class="page-subtitle">Set and track your sleep targets</p>
            </div>
            
            <div class="card">
                <h3 style="margin-bottom: 20px; color: #4a90e2;">Daily Sleep Goal</h3>
                <div class="form-group">
                    <label class="form-label">Target Sleep Duration</label>
                    <div class="form-row">
                        <input type="number" id="goalHours" class="form-input" min="4" max="12" value="8" placeholder="8">
                        <span style="color: #a0a0a0;">hours</span>
                        <input type="number" id="goalMinutes" class="form-input" min="0" max="59" value="0" placeholder="0">
                        <span style="color: #a0a0a0;">minutes</span>
                    </div>
                </div>
                <button class="btn-primary" onclick="saveGoal()">Save Goal</button>
            </div>
            
            <div class="card">
                <h3 style="margin-bottom: 20px; color: #4a90e2;">Current Progress</h3>
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="goalProgress" style="width: 0%"></div>
                    </div>
                    <div class="progress-text" id="progressText">0% of daily goal achieved</div>
                </div>
            </div>
            
            <div class="card">
                <h3 style="margin-bottom: 20px; color: #4a90e2;">Sleep Schedule</h3>
                <div class="form-group">
                    <label class="form-label">Ideal Bedtime</label>
                    <input type="time" id="idealBedtime" class="form-input" value="22:00">
                </div>
                <div class="form-group">
                    <label class="form-label">Ideal Wake Time</label>
                    <input type="time" id="idealWakeTime" class="form-input" value="06:00">
                </div>
                <button class="btn-primary" onclick="saveSchedule()">Save Schedule</button>
            </div>
            
            <div class="card">
                <h3 style="margin-bottom: 15px; color: #4a90e2;">Goal Statistics</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="stat-value" id="goalsAchieved">0</span>
                        <span class="stat-label">Goals Met</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="currentStreak">0</span>
                        <span class="stat-label">Day Streak</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Contact Page -->
        <div id="contactPage" class="page">
            <div class="page-header">
                <h1 class="page-title">Contact & Support</h1>
                <p class="page-subtitle">Get help and connect with us</p>
            </div>
            
            <div class="contact-info">
                <h3 style="margin-bottom: 20px; color: #4a90e2;">Sleep Tracker Pro</h3>
                <p style="color: #a0a0a0; margin-bottom: 20px;">
                    Your comprehensive sleep monitoring solution for better rest and improved wellness.
                </p>
                
                <div class="contact-links">
                    <a href="mailto:support@sleeptrakcer.pro" class="contact-link">
                        <div class="contact-icon">üìß</div>
                        <span>Email Support</span>
                    </a>
                    <a href="#" class="contact-link" onclick="openFeedback()">
                        <div class="contact-icon">üí¨</div>
                        <span>Feedback</span>
                    </a>
                    <a href="#" class="contact-link" onclick="showHelp()">
                        <div class="contact-icon">‚ùì</div>
                        <span>Help Center</span>
                    </a>
                </div>
            </div>
            
            <div class="card">
                <h3 style="margin-bottom: 20px; color: #4a90e2;">Send Feedback</h3>
                <div class="form-group">
                    <label class="form-label">Your Name</label>
                    <input type="text" id="feedbackName" class="form-input" placeholder="Enter your name">
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" id="feedbackEmail" class="form-input" placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label class="form-label">Message</label>
                    <textarea id="feedbackMessage" class="form-input" style="min-height: 100px; resize: vertical;" placeholder="Tell us about your experience or suggest improvements..."></textarea>
                </div>
                <button class="btn-primary" onclick="sendFeedback()">Send Feedback</button>
            </div>
            
            <div class="card">
                <h3 style="margin-bottom: 15px; color: #4a90e2;">App Information</h3>
                <div class="list-item">
                    <div class="item-header">
                        <span class="item-title">Version</span>
                        <span class="item-value">2.0.0</span>
                    </div>
                    <div class="item-subtitle">Sleep Tracker Pro</div>
                </div>
                <div class="list-item">
                    <div class="item-header">
                        <span class="item-title">Last Updated</span>
                        <span class="item-value">July 2025</span>
                    </div>
                    <div class="item-subtitle">Latest features and improvements</div>
                </div>
                <div class="list-item">
                    <div class="item-header">
                        <span class="item-title">Data Storage</span>
                        <span class="item-value">Local</span>
                    </div>
                    <div class="item-subtitle">Your data stays on your device</div>
                </div>
            </div>
        </div>

        <!-- Analytics Page -->
        <div id="analyticsPage" class="page">
            <div class="page-header">
                <h1 class="page-title">Sleep Analytics</h1>
                <p class="page-subtitle">Deep insights into your sleep patterns</p>
            </div>
            
            <div class="card">
                <h3 style="margin-bottom: 20px; color: #ff1493;">üìà Advanced Sleep Metrics</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="stat-value">87%</span>
                        <span class="stat-label">Sleep Efficiency</span>
                        <div class="metric-trend up">+3% ‚ÜóÔ∏è</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value">22:45</span>
                        <span class="stat-label">Avg Bedtime</span>
                        <div class="metric-trend down">-15min ‚ÜòÔ∏è</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value">06:30</span>
                        <span class="stat-label">Avg Wake</span>
                        <div class="metric-trend up">+5min ‚ÜóÔ∏è</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value">92</span>
                        <span class="stat-label">Sleep Score</span>
                        <div class="metric-trend up">+8 ‚ÜóÔ∏è</div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3 style="margin-bottom: 20px; color: #ff1493;">üåô Sleep Quality Analysis</h3>
                <div class="quality-breakdown">
                    <div class="quality-item">
                        <span class="quality-emoji">üò¥</span>
                        <span class="quality-text">Deep Sleep Quality: </span>
                        <span class="quality-score excellent">Excellent</span>
                    </div>
                    <div class="quality-item">
                        <span class="quality-emoji">üí§</span>
                        <span class="quality-text">Sleep Consistency: </span>
                        <span class="quality-score good">Good</span>
                    </div>
                    <div class="quality-item">
                        <span class="quality-emoji">‚è∞</span>
                        <span class="quality-text">Sleep Timing: </span>
                        <span class="quality-score fair">Needs Work</span>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3 style="margin-bottom: 20px; color: #ff1493;">üî• Sleep Records & Achievements</h3>
                <div class="records-grid">
                    <div class="record-item">
                        <div class="record-icon">üèÜ</div>
                        <div class="record-info">
                            <div class="record-title">Longest Streak</div>
                            <div class="record-value">14 days</div>
                        </div>
                    </div>
                    <div class="record-item">
                        <div class="record-icon">‚≠ê</div>
                        <div class="record-info">
                            <div class="record-title">Best Sleep Score</div>
                            <div class="record-value">98/100</div>
                        </div>
                    </div>
                    <div class="record-item">
                        <div class="record-icon">üí§</div>
                        <div class="record-info">
                            <div class="record-title">Longest Sleep</div>
                            <div class="record-value">9h 45m</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Page -->
        <div id="settingsPage" class="page">
            <div class="page-header">
                <h1 class="page-title">Settings</h1>
                <p class="page-subtitle">Customize your sleep experience</p>
            </div>
            
            <div class="card">
                <h3 style="margin-bottom: 20px; color: #ff1493;">üéµ Sleep Sounds & Ambience</h3>
                <div class="quick-actions">
                    <div class="action-card" onclick="toggleSound('rain')">
                        <div class="action-icon">üåßÔ∏è</div>
                        <div class="action-label">Rain Sounds</div>
                    </div>
                    <div class="action-card" onclick="toggleSound('ocean')">
                        <div class="action-icon">üåä</div>
                        <div class="action-label">Ocean Waves</div>
                    </div>
                    <div class="action-card" onclick="toggleSound('forest')">
                        <div class="action-icon">üå≤</div>
                        <div class="action-label">Forest Sounds</div>
                    </div>
                    <div class="action-card" onclick="toggleSound('white')">
                        <div class="action-icon">‚ö™</div>
                        <div class="action-label">White Noise</div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3 style="margin-bottom: 20px; color: #ff1493;">‚ö° Power Features</h3>
                <button class="btn-primary" onclick="exportSleepData()">
                    üìä Export Sleep Data to CSV
                </button>
                <div style="margin-top: 15px;">
                    <button class="btn-primary" onclick="shareProgress()">
                        üì± Share Your Sleep Progress
                    </button>
                </div>
                <div style="margin-top: 15px;">
                    <button class="btn-primary" onclick="startSleepChallenge()">
                        üèÜ Start 30-Day Sleep Challenge
                    </button>
                </div>
            </div>
            
            <div class="card">
                <h3 style="margin-bottom: 20px; color: #ff1493;">üîß App Preferences</h3>
                <div class="setting-item">
                    <label class="setting-label">
                        <input type="checkbox" id="darkMode" checked>
                        üåô Dark Mode
                    </label>
                </div>
                <div class="setting-item">
                    <label class="setting-label">
                        <input type="checkbox" id="notifications" checked>
                        üîî Push Notifications
                    </label>
                </div>
                <div class="setting-item">
                    <label class="setting-label">
                        <input type="checkbox" id="vibration" checked>
                        üì± Haptic Feedback
                    </label>
                </div>
                <div class="setting-item">
                    <label class="setting-label">
                        <input type="checkbox" id="autoTracking" checked>
                        ü§ñ Smart Auto-Tracking
                    </label>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="nav-container">
        <div class="nav-menu">
            <div class="nav-item active" onclick="showPage('homePage')" data-page="homePage">
                <div class="nav-icon">üè†</div>
                <div class="nav-label">Home</div>
            </div>
            <div class="nav-item" onclick="showPage('sleepPage')" data-page="sleepPage">
                <div class="nav-icon">üõèÔ∏è</div>
                <div class="nav-label">Sleep</div>
            </div>
            <div class="nav-item" onclick="showPage('analyticsPage')" data-page="analyticsPage">
                <div class="nav-icon">üìä</div>
                <div class="nav-label">Analytics</div>
            </div>
            <div class="nav-item" onclick="showPage('goalsPage')" data-page="goalsPage">
                <div class="nav-icon">üéØ</div>
                <div class="nav-label">Goals</div>
            </div>
            <div class="nav-item" onclick="showPage('settingsPage')" data-page="settingsPage">
                <div class="nav-icon">‚öôÔ∏è</div>
                <div class="nav-label">Settings</div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let isTracking = false;
        let startTime = null;
        let trackingInterval = null;
        let selectedQuality = null;
        let sleepGoal = { hours: 8, minutes: 0 };
        let idealSchedule = { bedtime: '22:00', wakeTime: '06:00' };
        
        // Audio context for sound effects
        let audioContext = null;
        
        // Initialize audio context
        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }
        
        // Enhanced sound effect functions with better quality
        function playClickSound() {
            initAudio();
            
            // Create multiple oscillators for richer sound
            const osc1 = audioContext.createOscillator();
            const osc2 = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            const filterNode = audioContext.createBiquadFilter();
            
            // Setup filter for warmth
            filterNode.type = 'lowpass';
            filterNode.frequency.setValueAtTime(2000, audioContext.currentTime);
            filterNode.Q.setValueAtTime(1, audioContext.currentTime);
            
            // Connect audio graph
            osc1.connect(filterNode);
            osc2.connect(filterNode);
            filterNode.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            // Main tone
            osc1.frequency.setValueAtTime(880, audioContext.currentTime); // A5
            osc1.frequency.exponentialRampToValueAtTime(660, audioContext.currentTime + 0.12);
            
            // Harmonic for richness
            osc2.frequency.setValueAtTime(1320, audioContext.currentTime); // E6
            osc2.frequency.exponentialRampToValueAtTime(990, audioContext.currentTime + 0.12);
            
            // Better envelope
            gainNode.gain.setValueAtTime(0, audioContext.currentTime);
            gainNode.gain.linearRampToValueAtTime(0.12, audioContext.currentTime + 0.01);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.12);
            
            osc1.start(audioContext.currentTime);
            osc2.start(audioContext.currentTime);
            osc1.stop(audioContext.currentTime + 0.12);
            osc2.stop(audioContext.currentTime + 0.12);
        }
        
        function playHoverSound() {
            initAudio();
            
            // Subtle, high-quality hover sound
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            const filterNode = audioContext.createBiquadFilter();
            
            // Setup filter for smooth tone
            filterNode.type = 'bandpass';
            filterNode.frequency.setValueAtTime(800, audioContext.currentTime);
            filterNode.Q.setValueAtTime(2, audioContext.currentTime);
            
            oscillator.connect(filterNode);
            filterNode.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            // Gentle upward sweep
            oscillator.frequency.setValueAtTime(600, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(800, audioContext.currentTime + 0.06);
            
            // Soft envelope
            gainNode.gain.setValueAtTime(0, audioContext.currentTime);
            gainNode.gain.linearRampToValueAtTime(0.04, audioContext.currentTime + 0.01);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.06);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.06);
        }
        
        function playSuccessSound() {
            initAudio();
            
            // Rich chord progression with multiple oscillators
            const frequencies = [523.25, 659.25, 783.99]; // C5, E5, G5 major chord
            const oscillators = [];
            const gainNodes = [];
            const filterNode = audioContext.createBiquadFilter();
            const masterGain = audioContext.createGain();
            
            // Setup filter
            filterNode.type = 'lowpass';
            filterNode.frequency.setValueAtTime(3000, audioContext.currentTime);
            filterNode.Q.setValueAtTime(0.5, audioContext.currentTime);
            
            filterNode.connect(masterGain);
            masterGain.connect(audioContext.destination);
            
            frequencies.forEach((freq, index) => {
                const osc = audioContext.createOscillator();
                const gain = audioContext.createGain();
                
                osc.connect(gain);
                gain.connect(filterNode);
                
                // Stagger the chord notes slightly
                const startTime = audioContext.currentTime + (index * 0.05);
                
                osc.frequency.setValueAtTime(freq, startTime);
                
                // Individual note envelope
                gain.gain.setValueAtTime(0, startTime);
                gain.gain.linearRampToValueAtTime(0.08, startTime + 0.02);
                gain.gain.exponentialRampToValueAtTime(0.001, startTime + 0.4);
                
                osc.start(startTime);
                osc.stop(startTime + 0.4);
                
                oscillators.push(osc);
                gainNodes.push(gain);
            });
            
            // Master envelope
            masterGain.gain.setValueAtTime(1, audioContext.currentTime);
            masterGain.gain.exponentialRampToValueAtTime(0.3, audioContext.currentTime + 0.5);
        }
        
        function playNavSound() {
            initAudio();
            
            // Smooth navigation sound with filter sweep
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            const filterNode = audioContext.createBiquadFilter();
            
            filterNode.type = 'lowpass';
            filterNode.frequency.setValueAtTime(800, audioContext.currentTime);
            filterNode.frequency.exponentialRampToValueAtTime(1200, audioContext.currentTime + 0.1);
            filterNode.Q.setValueAtTime(1.5, audioContext.currentTime);
            
            oscillator.connect(filterNode);
            filterNode.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(440, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(550, audioContext.currentTime + 0.1);
            
            gainNode.gain.setValueAtTime(0, audioContext.currentTime);
            gainNode.gain.linearRampToValueAtTime(0.06, audioContext.currentTime + 0.01);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.1);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.1);
        }
        
        function playTrackingSound() {
            initAudio();
            
            // Deep, soothing tracking sound
            const osc1 = audioContext.createOscillator();
            const osc2 = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            const filterNode = audioContext.createBiquadFilter();
            
            // Low-pass filter for warmth
            filterNode.type = 'lowpass';
            filterNode.frequency.setValueAtTime(400, audioContext.currentTime);
            filterNode.Q.setValueAtTime(2, audioContext.currentTime);
            
            osc1.connect(filterNode);
            osc2.connect(filterNode);
            filterNode.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            // Main deep tone
            osc1.frequency.setValueAtTime(220, audioContext.currentTime); // A3
            osc1.frequency.exponentialRampToValueAtTime(165, audioContext.currentTime + 0.6); // E3
            
            // Sub-harmonic
            osc2.frequency.setValueAtTime(110, audioContext.currentTime); // A2
            osc2.frequency.exponentialRampToValueAtTime(82.5, audioContext.currentTime + 0.6); // E2
            
            // Gentle fade
            gainNode.gain.setValueAtTime(0, audioContext.currentTime);
            gainNode.gain.linearRampToValueAtTime(0.08, audioContext.currentTime + 0.1);
            gainNode.gain.linearRampToValueAtTime(0.06, audioContext.currentTime + 0.3);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.6);
            
            osc1.start(audioContext.currentTime);
            osc2.start(audioContext.currentTime);
            osc1.stop(audioContext.currentTime + 0.6);
            osc2.stop(audioContext.currentTime + 0.6);
        }
        
        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            createStars();
            createFloatingShapes();
            loadStoredData();
            updateDisplay();
            updateWeeklyChart();
            updateGoalProgress();
            generateInsights();
            addHoverSounds(); // Add hover sound effects
            
            // Initialize advanced features
            initializeSleepAnalysis();
            initializeCircadianTracking();
            initializeSleepDebt();
            initializeEnvironmentMonitoring();
            
            // Enable audio on first user interaction
            document.addEventListener('click', function enableAudio() {
                initAudio();
                document.removeEventListener('click', enableAudio);
            }, { once: true });
        });
        
        // Add hover sound effects to interactive elements
        function addHoverSounds() {
            // Add hover sounds to navigation items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('mouseenter', playHoverSound);
            });
            
            // Add hover sounds to action cards
            document.querySelectorAll('.action-card').forEach(card => {
                card.addEventListener('mouseenter', playHoverSound);
            });
            
            // Add hover sounds to quality options
            document.querySelectorAll('.quality-option').forEach(option => {
                option.addEventListener('mouseenter', playHoverSound);
            });
            
            // Add hover sounds to buttons
            document.querySelectorAll('.btn-primary, .btn-secondary').forEach(button => {
                button.addEventListener('mouseenter', playHoverSound);
            });
            
            // Add hover sounds to stat cards
            document.querySelectorAll('.stat-card').forEach(card => {
                card.addEventListener('mouseenter', playHoverSound);
            });
            
            // Add hover sounds to list items
            document.querySelectorAll('.list-item').forEach(item => {
                item.addEventListener('mouseenter', playHoverSound);
            });
            
            // Add hover sounds to contact links
            document.querySelectorAll('.contact-link').forEach(link => {
                link.addEventListener('mouseenter', playHoverSound);
            });
            
            // Add hover sounds to cards
            document.querySelectorAll('.card').forEach(card => {
                card.addEventListener('mouseenter', playHoverSound);
            });
            
            // Add hover sounds to chart bars
            document.querySelectorAll('.bar').forEach(bar => {
                bar.addEventListener('mouseenter', playHoverSound);
            });
            
            // Add focus sounds to form inputs
            document.querySelectorAll('.form-input').forEach(input => {
                input.addEventListener('focus', playHoverSound);
            });
            
            // Add hover sounds to tracking interface
            const trackingInterface = document.querySelector('.tracking-interface');
            if (trackingInterface) {
                trackingInterface.addEventListener('mouseenter', playHoverSound);
            }
        }
        
        // Create animated background stars
        function createStars() {
            const starsContainer = document.getElementById('stars');
            const starCount = 100;
            
            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.width = Math.random() * 3 + 1 + 'px';
                star.style.height = star.style.width;
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }
        
        // Create floating shapes
        function createFloatingShapes() {
            const bgAnimation = document.querySelector('.bg-animation');
            const shapeCount = 15;
            
            for (let i = 0; i < shapeCount; i++) {
                const shape = document.createElement('div');
                shape.className = 'floating-shape';
                shape.style.left = Math.random() * 100 + '%';
                shape.style.top = Math.random() * 100 + '%';
                shape.style.width = Math.random() * 60 + 20 + 'px';
                shape.style.height = shape.style.width;
                shape.style.animationDelay = Math.random() * 6 + 's';
                shape.style.animationDuration = (Math.random() * 4 + 4) + 's';
                bgAnimation.appendChild(shape);
            }
        }
        
        // Navigation functions
        function showPage(pageId) {
            playNavSound(); // Add navigation sound
            
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show selected page
            document.getElementById(pageId).classList.add('active');
            
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-page="${pageId}"]`).classList.add('active');
            
            // Update content based on page
            if (pageId === 'homePage') {
                updateDisplay();
                updateWeeklyChart();
                generateInsights();
            } else if (pageId === 'goalsPage') {
                updateGoalProgress();
            } else if (pageId === 'sleepPage') {
                displayRecentSessions();
            }
        }
        
        // Sleep tracking functions
        function toggleTracking() {
            if (!isTracking) {
                startTracking();
            } else {
                stopTracking();
            }
        }
        
        function startTracking() {
            playTrackingSound(); // Add tracking start sound
            
            isTracking = true;
            startTime = new Date();
            
            document.getElementById('trackingStatus').textContent = 'Sleep tracking in progress...';
            document.getElementById('toggleTrackingBtn').textContent = '‚è∞ Stop Sleep Tracking';
            document.getElementById('toggleTrackingBtn').className = 'btn-secondary';
            
            trackingInterval = setInterval(updateLiveTimer, 1000);
            updateLiveTimer();
        }
        
        function stopTracking() {
            if (!isTracking || !startTime) return;
            
            playSuccessSound(); // Add success sound for completing sleep session
            
            const endTime = new Date();
            const duration = endTime - startTime;
            
            isTracking = false;
            clearInterval(trackingInterval);
            
            // Save sleep session
            const session = {
                id: Date.now(),
                startTime: startTime.toISOString(),
                endTime: endTime.toISOString(),
                duration: duration,
                quality: selectedQuality || 'good',
                date: new Date().toDateString()
            };
            
            saveSleepSession(session);
            
            // Reset UI
            document.getElementById('trackingStatus').textContent = 'Sleep session completed!';
            document.getElementById('toggleTrackingBtn').textContent = 'üåô Start Sleep Tracking';
            document.getElementById('toggleTrackingBtn').className = 'btn-primary';
            document.getElementById('liveTimer').textContent = formatDuration(duration);
            
            // Update displays
            setTimeout(() => {
                updateDisplay();
                updateWeeklyChart();
                updateGoalProgress();
                displayRecentSessions();
                generateInsights();
            }, 2000);
            
            // Reset for next session
            startTime = null;
            selectedQuality = null;
            document.querySelectorAll('.quality-option').forEach(option => {
                option.classList.remove('selected');
            });
        }
        
        function updateLiveTimer() {
            if (!startTime) return;
            
            const now = new Date();
            const elapsed = now - startTime;
            document.getElementById('liveTimer').textContent = formatDuration(elapsed);
        }
        
        // Quality selection
        function selectQuality(quality) {
            playClickSound(); // Add click sound for quality selection
            
            selectedQuality = quality;
            document.querySelectorAll('.quality-option').forEach(option => {
                option.classList.remove('selected');
            });
            event.target.classList.add('selected');
        }
        
        // Data management
        function saveSleepSession(session) {
            let sessions = JSON.parse(localStorage.getItem('sleepSessions')) || [];
            sessions.push(session);
            localStorage.setItem('sleepSessions', JSON.stringify(sessions));
        }
        
        function getSleepSessions() {
            return JSON.parse(localStorage.getItem('sleepSessions')) || [];
        }
        
        function loadStoredData() {
            // Load sleep goal
            const storedGoal = localStorage.getItem('sleepGoal');
            if (storedGoal) {
                sleepGoal = JSON.parse(storedGoal);
                document.getElementById('goalHours').value = sleepGoal.hours;
                document.getElementById('goalMinutes').value = sleepGoal.minutes;
            }
            
            // Load ideal schedule
            const storedSchedule = localStorage.getItem('idealSchedule');
            if (storedSchedule) {
                idealSchedule = JSON.parse(storedSchedule);
                document.getElementById('idealBedtime').value = idealSchedule.bedtime;
                document.getElementById('idealWakeTime').value = idealSchedule.wakeTime;
            }
        }
        
        // Goal management
        function saveGoal() {
            playSuccessSound(); // Add success sound for saving goal
            
            const hours = parseInt(document.getElementById('goalHours').value) || 8;
            const minutes = parseInt(document.getElementById('goalMinutes').value) || 0;
            
            sleepGoal = { hours, minutes };
            localStorage.setItem('sleepGoal', JSON.stringify(sleepGoal));
            
            updateGoalProgress();
            showNotification('Sleep goal saved successfully!');
        }
        
        function saveSchedule() {
            playSuccessSound(); // Add success sound for saving schedule
            
            const bedtime = document.getElementById('idealBedtime').value;
            const wakeTime = document.getElementById('idealWakeTime').value;
            
            idealSchedule = { bedtime, wakeTime };
            localStorage.setItem('idealSchedule', JSON.stringify(idealSchedule));
            
            showNotification('Sleep schedule saved successfully!');
        }
        
        function updateGoalProgress() {
            const sessions = getSleepSessions();
            const today = new Date().toDateString();
            const todaySessions = sessions.filter(s => new Date(s.startTime).toDateString() === today);
            
            const totalTodayDuration = todaySessions.reduce((sum, session) => sum + session.duration, 0);
            const goalDurationMs = (sleepGoal.hours * 60 + sleepGoal.minutes) * 60 * 1000;
            
            const progressPercent = Math.min((totalTodayDuration / goalDurationMs) * 100, 100);
            
            document.getElementById('goalProgress').style.width = progressPercent + '%';
            document.getElementById('progressText').textContent = 
                `${Math.round(progressPercent)}% of daily goal achieved`;
            document.getElementById('goalProgressDisplay').textContent = Math.round(progressPercent) + '%';
        }
        
        // Display functions
        function updateDisplay() {
            const sessions = getSleepSessions();
            
            // Calculate average sleep
            if (sessions.length > 0) {
                const totalDuration = sessions.reduce((sum, session) => sum + session.duration, 0);
                const avgDuration = totalDuration / sessions.length;
                document.getElementById('avgSleepDisplay').textContent = formatDuration(avgDuration);
            }
            
            // Update session count
            document.getElementById('totalSessionsDisplay').textContent = sessions.length;
            
            // Calculate streak
            const streak = calculateStreak(sessions);
            document.getElementById('streakDisplay').textContent = streak;
        }
        
        function displayRecentSessions() {
            const sessions = getSleepSessions();
            const recentContainer = document.getElementById('recentSessions');
            
            if (sessions.length === 0) {
                recentContainer.innerHTML = '<p class="item-subtitle text-center">No sleep sessions recorded yet</p>';
                return;
            }
            
            const recentSessions = sessions.slice(-5).reverse();
            
            recentContainer.innerHTML = recentSessions.map(session => `
                <div class="list-item">
                    <div class="item-header">
                        <span class="item-title">${new Date(session.startTime).toLocaleDateString()}</span>
                        <span class="item-value">${formatDuration(session.duration)}</span>
                    </div>
                    <div class="item-subtitle">
                        Quality: ${capitalizeFirst(session.quality)} ‚Ä¢ 
                        ${new Date(session.startTime).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})} - 
                        ${new Date(session.endTime).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                    </div>
                </div>
            `).join('');
            
            // Add hover sounds to newly created list items
            recentContainer.querySelectorAll('.list-item').forEach(item => {
                item.addEventListener('mouseenter', playHoverSound);
            });
        }
        
        function updateWeeklyChart() {
            const sessions = getSleepSessions();
            const chartContainer = document.getElementById('weeklyChart');
            
            // Get last 7 days
            const days = [];
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                days.push(date);
            }
            
            const maxHeight = 100;
            const maxDuration = 10 * 60 * 60 * 1000; // 10 hours in ms
            
            chartContainer.innerHTML = days.map(day => {
                const dayString = day.toDateString();
                const daySessions = sessions.filter(s => new Date(s.startTime).toDateString() === dayString);
                const totalDuration = daySessions.reduce((sum, session) => sum + session.duration, 0);
                const height = Math.max((totalDuration / maxDuration) * maxHeight, 5);
                
                return `
                    <div class="bar" 
                         style="height: ${height}px;" 
                         data-label="${day.toLocaleDateString('en', {weekday: 'short'})}"
                         title="${formatDuration(totalDuration)}">
                    </div>
                `;
            }).join('');
            
            // Add hover sounds to newly created bars
            chartContainer.querySelectorAll('.bar').forEach(bar => {
                bar.addEventListener('mouseenter', playHoverSound);
            });
        }
        
        function generateInsights() {
            const sessions = getSleepSessions();
            const insightElement = document.getElementById('personalizedInsight');
            
            if (sessions.length === 0) {
                insightElement.textContent = "Start tracking your sleep to receive personalized insights about your sleep patterns.";
                return;
            }
            
            let insight = "";
            
            if (sessions.length < 7) {
                insight = `üí™ You've tracked ${sessions.length} sleep session${sessions.length > 1 ? 's' : ''}! Keep building that momentum - every night counts toward better health!`;
            } else {
                const recentSessions = sessions.slice(-7);
                const avgDuration = recentSessions.reduce((sum, s) => sum + s.duration, 0) / recentSessions.length;
                const avgHours = avgDuration / (1000 * 60 * 60);
                
                if (avgHours < 6) {
                    insight = "üö® ALERT: You're averaging less than 6 hours! Your health is at risk. Time to prioritize sleep NOW!";
                } else if (avgHours > 9) {
                    insight = "üåü SUPERSTAR! You're getting amazing sleep! Keep dominating those Z's for peak performance!";
                } else if (avgHours >= 8) {
                    insight = `üî• CHAMPION! Your ${avgHours.toFixed(1)} hour average is absolutely crushing it! You're in the elite sleep zone!`;
                } else if (avgHours >= 7) {
                    insight = `‚ö° SOLID WORK! Your ${avgHours.toFixed(1)} hours is good, but let's push for 8+ hours to unlock MAXIMUM potential!`;
                } else {
                    insight = `‚ö†Ô∏è NEEDS BOOST! Your ${avgHours.toFixed(1)} hours needs improvement. Push harder for better sleep - your future self will thank you!`;
                }
            }
            
            insightElement.textContent = insight;
        }
        
        // Contact functions
        function sendFeedback() {
            const name = document.getElementById('feedbackName').value;
            const email = document.getElementById('feedbackEmail').value;
            const message = document.getElementById('feedbackMessage').value;
            
            if (!name || !email || !message) {
                playClickSound(); // Click sound for error
                showNotification('Please fill in all fields');
                return;
            }
            
            playSuccessSound(); // Success sound for sending feedback
            
            // Simulate sending feedback
            showNotification('Thank you for your feedback! We\'ll get back to you soon.');
            
            // Clear form
            document.getElementById('feedbackName').value = '';
            document.getElementById('feedbackEmail').value = '';
            document.getElementById('feedbackMessage').value = '';
        }
        
        function openFeedback() {
            playClickSound(); // Add click sound
            showNotification('Feedback form is available in the Contact section');
        }
        
        function showHelp() {
            playClickSound(); // Add click sound
            showNotification('Visit our help center at help.sleeptracker.pro');
        }
        
        function viewHistory() {
            playNavSound(); // Add navigation sound
            showPage('sleepPage');
        }
        
        // Utility functions
        function formatDuration(milliseconds) {
            if (!milliseconds || milliseconds < 0) return '0h 0m';
            
            const hours = Math.floor(milliseconds / (1000 * 60 * 60));
            const minutes = Math.floor((milliseconds % (1000 * 60 * 60)) / (1000 * 60));
            
            return `${hours}h ${minutes}m`;
        }
        
        function calculateStreak(sessions) {
            if (sessions.length === 0) return 0;
            
            // Sort sessions by date
            const sortedSessions = sessions.sort((a, b) => new Date(b.startTime) - new Date(a.startTime));
            
            let streak = 0;
            let currentDate = new Date();
            currentDate.setHours(0, 0, 0, 0);
            
            for (let session of sortedSessions) {
                const sessionDate = new Date(session.startTime);
                sessionDate.setHours(0, 0, 0, 0);
                
                if (sessionDate.getTime() === currentDate.getTime()) {
                    streak++;
                    currentDate.setDate(currentDate.getDate() - 1);
                } else if (sessionDate.getTime() < currentDate.getTime()) {
                    break;
                }
            }
            
            return streak;
        }
        
        function capitalizeFirst(str) {
            return str.charAt(0).toUpperCase() + str.slice(1);
        }
        
        // New enhanced features
        function showSleepEnvironment() {
            playClickSound();
            showNotification('üåô Sleep Mode activated! Dimming screen and enabling Do Not Disturb...');
            
            // Simulate sleep mode by dimming the app
            document.body.style.filter = 'brightness(0.3)';
            setTimeout(() => {
                document.body.style.filter = 'brightness(1)';
                showNotification('‚òÄÔ∏è Sleep Mode deactivated. Good morning!');
            }, 3000);
        }
        
        function showMeditationGuide() {
            playSuccessSound();
            showNotification('üßò Starting 5-minute breathing meditation...');
            
            // Simulate meditation timer
            let seconds = 5;
            const interval = setInterval(() => {
                showNotification(`ü´Å Breathe... ${seconds} seconds remaining`);
                seconds--;
                if (seconds < 0) {
                    clearInterval(interval);
                    showNotification('‚ú® Meditation complete! You\'re ready for peaceful sleep.');
                }
            }, 1000);
        }
        
        function showSmartAlarm() {
            playClickSound();
            const wakeTime = prompt('üîî Set your wake-up time (HH:MM):', '07:00');
            if (wakeTime) {
                showNotification(`‚è∞ Smart alarm set for ${wakeTime}! I'll wake you during light sleep within 30 minutes.`);
                localStorage.setItem('smartAlarm', JSON.stringify({
                    time: wakeTime,
                    enabled: true,
                    smartWake: true
                }));
            }
        }
        
        function showSleepStories() {
            playClickSound();
            const stories = [
                'üå≤ The Enchanted Forest Journey',
                'üåä Peaceful Ocean Waves',
                'üèîÔ∏è Mountain Serenity',
                'üåô Moonlit Garden Walk',
                '‚òÅÔ∏è Floating on Clouds'
            ];
            const randomStory = stories[Math.floor(Math.random() * stories.length)];
            showNotification(`üìñ Starting sleep story: "${randomStory}"... Sweet dreams!`);
        }
        
        function exportSleepData() {
            playSuccessSound();
            const sessions = getSleepSessions();
            
            if (sessions.length === 0) {
                showNotification('‚ùå No sleep data to export yet. Start tracking your sleep first!');
                return;
            }
            
            // Create CSV content
            let csvContent = "Date,Start Time,End Time,Duration (hours),Quality,Sleep Score\n";
            
            sessions.forEach(session => {
                const startDate = new Date(session.startTime);
                const endDate = new Date(session.endTime);
                const durationHours = (session.duration / (1000 * 60 * 60)).toFixed(2);
                const sleepScore = Math.floor(Math.random() * 30) + 70; // Random score 70-100
                
                csvContent += `${startDate.toDateString()},${startDate.toTimeString().split(' ')[0]},${endDate.toTimeString().split(' ')[0]},${durationHours},${session.quality || 'good'},${sleepScore}\n`;
            });
            
            // Create download link
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'sleep-tracker-data.csv';
            a.click();
            window.URL.revokeObjectURL(url);
            
            showNotification('üìä Sleep data exported successfully! Check your downloads folder.');
        }
        
        function shareProgress() {
            playSuccessSound();
            const sessions = getSleepSessions();
            
            if (sessions.length === 0) {
                showNotification('‚ùå No sleep data to share yet. Start tracking your sleep first!');
                return;
            }
            
            const avgDuration = sessions.reduce((sum, s) => sum + s.duration, 0) / sessions.length;
            const avgHours = Math.floor(avgDuration / (1000 * 60 * 60));
            const avgMinutes = Math.floor((avgDuration % (1000 * 60 * 60)) / (1000 * 60));
            const streak = calculateStreak(sessions);
            
            const shareText = `üåô My Sleep Progress with Sleep Tracker Pro:\n‚ú® Average Sleep: ${avgHours}h ${avgMinutes}m\nüî• Current Streak: ${streak} days\nüìä Total Sessions: ${sessions.length}\n\nJoin me in improving your sleep! #SleepTrackerPro #BetterSleep`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'My Sleep Progress',
                    text: shareText
                });
            } else {
                // Fallback: copy to clipboard
                navigator.clipboard.writeText(shareText).then(() => {
                    showNotification('üì± Progress copied to clipboard! Share it anywhere you like!');
                });
            }
        }
        
        function startSleepChallenge() {
            playSuccessSound();
            const challengeStart = new Date().toDateString();
            localStorage.setItem('sleepChallenge', JSON.stringify({
                startDate: challengeStart,
                target: 30,
                completed: 0
            }));
            
            showNotification('üèÜ 30-Day Sleep Challenge started! Track your sleep daily to build the ultimate sleep habit!');
        }
        
        function toggleSound(soundType) {
            playClickSound();
            const soundEmojis = {
                rain: 'üåßÔ∏è',
                ocean: 'üåä',
                forest: 'üå≤',
                white: '‚ö™'
            };
            
            const soundNames = {
                rain: 'Rain Sounds',
                ocean: 'Ocean Waves',
                forest: 'Forest Ambience',
                white: 'White Noise'
            };
            
            showNotification(`${soundEmojis[soundType]} ${soundNames[soundType]} ${Math.random() > 0.5 ? 'enabled' : 'disabled'}!`);
            
            // Save sound preference
            let soundSettings = JSON.parse(localStorage.getItem('soundSettings')) || {};
            soundSettings[soundType] = !soundSettings[soundType];
            localStorage.setItem('soundSettings', JSON.stringify(soundSettings));
        }
        
        function showNotification(message) {
            // Create a more assertive notification with gradient and animation
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #ff1493, #8a2be2, #1e90ff);
                color: white;
                padding: 20px 25px;
                border-radius: 15px;
                z-index: 10000;
                backdrop-filter: blur(20px);
                box-shadow: 0 15px 40px rgba(255, 20, 147, 0.4), 0 0 30px rgba(138, 43, 226, 0.3);
                transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
                font-weight: 600;
                font-size: 16px;
                border: 2px solid rgba(255, 255, 255, 0.2);
                max-width: 300px;
                transform: translateX(400px);
                animation: notificationSlide 0.4s ease forwards;
            `;
            
            // Add CSS animation keyframes
            if (!document.querySelector('#notification-styles')) {
                const style = document.createElement('style');
                style.id = 'notification-styles';
                style.textContent = `
                    @keyframes notificationSlide {
                        from { transform: translateX(400px); opacity: 0; }
                        to { transform: translateX(0px); opacity: 1; }
                    }
                    @keyframes notificationPulse {
                        0%, 100% { transform: scale(1); }
                        50% { transform: scale(1.05); }
                    }
                `;
                document.head.appendChild(style);
            }
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // Add pulse animation
            setTimeout(() => {
                notification.style.animation = 'notificationPulse 0.6s ease';
            }, 500);
            
            // Remove notification
            setTimeout(() => {
                notification.style.transform = 'translateX(400px)';
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 400);
            }, 4000);
        }

        // ü§ñ AI COACH - Advanced sleep coaching
        function showAICoach() {
            playSuccessSound();
            const tips = [
                'üß† AI Insight: Your optimal sleep window is 10:30 PM - 6:30 AM based on your circadian rhythm!',
                '‚ö° Performance Tip: Cool your room to 65-68¬∞F for maximum REM sleep optimization!',
                'üßò Mind Hack: Try the 4-7-8 breathing technique - inhale 4, hold 7, exhale 8!',
                'üì± Digital Detox: Blue light exposure after 9 PM reduces melatonin by 23%!',
                'üçÉ Natural Boost: Magnesium supplements 1 hour before bed improve deep sleep by 15%!'
            ];
            const tip = tips[Math.floor(Math.random() * tips.length)];
            showNotification(`ü§ñ AI COACH: ${tip}`);
        }

        // üî¨ SLEEP LAB - Advanced analytics
        function showSleepLab() {
            playSuccessSound();
            const labResults = [
                'üî¨ Lab Analysis: Your sleep efficiency is 94% - EXCELLENT performance!',
                'üìä Biometric Reading: Heart rate variability suggests optimal recovery!',
                'üß¨ Sleep Architecture: 23% deep sleep, 52% light sleep, 25% REM - PERFECT ratio!',
                '‚ö° Recovery Score: 96/100 - Your body is performing at peak levels!',
                'üß† Cognitive Performance: Sleep quality correlates with 18% improved focus!'
            ];
            const result = labResults[Math.floor(Math.random() * labResults.length)];
            showNotification(`üî¨ SLEEP LAB: ${result}`);
        }

        // üíì BIOMETRICS - Advanced health monitoring
        function showBiometrics() {
            playSuccessSound();
            const metrics = [
                'üíì Heart Rate: Resting 58 BPM - ATHLETE LEVEL performance!',
                'ü´Å Respiratory Rate: 14 BPM - Optimal breathing pattern detected!',
                'üå°Ô∏è Core Temperature: 97.8¬∞F - Perfect thermoregulation!',
                'üß† HRV Score: 45ms - EXCELLENT autonomic nervous system balance!',
                '‚ö° Stress Level: 12% - Ultra-low stress, maximum recovery mode!'
            ];
            const metric = metrics[Math.floor(Math.random() * metrics.length)];
            showNotification(`üíì BIOMETRICS: ${metric}`);
        }

        // üí≠ DREAM JOURNAL - Advanced dream tracking
        function showDreamJournal() {
            playSuccessSound();
            const dreams = [
                'üí≠ Dream Pattern: Lucid dreaming detected in 73% of REM cycles!',
                'üåà Dream Quality: Vivid, colorful dreams indicate optimal brain health!',
                'üöÄ Creative Dreams: Problem-solving dreams boost innovation by 23%!',
                'üß† Memory Consolidation: Dreams processing 2.4GB of daily experiences!',
                '‚ú® Prophetic Dreams: Pattern recognition shows 89% accuracy rate!'
            ];
            const dream = dreams[Math.floor(Math.random() * dreams.length)];
            showNotification(`üí≠ DREAM JOURNAL: ${dream}`);
        }

        // üåÄ SLEEP HYPNOSIS - Advanced relaxation
        function showSleepHypnosis() {
            playSuccessSound();
            const sessions = [
                'üåÄ Hypnosis Session: "Deep Ocean Trance" - 20 minutes of pure relaxation!',
                'üßò Neural Programming: "Confidence Boost While You Sleep" activated!',
                '‚ú® Subliminal Audio: "Peak Performance Programming" now playing!',
                'üåô Theta Waves: "Creative Genius Activation" - 8Hz frequency engaged!',
                'üîÆ Quantum Healing: "Cellular Regeneration Protocol" initiated!'
            ];
            const session = sessions[Math.floor(Math.random() * sessions.length)];
            showNotification(`üåÄ HYPNOSIS: ${session}`);
        }

        // ‚ö° PERFORMANCE MODE - Maximum optimization
        function showPerformanceMode() {
            playSuccessSound();
            const modes = [
                '‚ö° BEAST MODE: Sleep optimization for 300% energy boost activated!',
                'üöÄ TURBO RECOVERY: Advanced sleep cycles for superhuman performance!',
                'üß† GENIUS MODE: Neural enhancement protocols for peak brain function!',
                'üí™ WARRIOR MODE: Military-grade sleep optimization for maximum strength!',
                'üèÜ CHAMPION MODE: Elite athlete sleep patterns for legendary performance!'
            ];
            const mode = modes[Math.floor(Math.random() * modes.length)];
            showNotification(`‚ö° PERFORMANCE: ${mode}`);
        }

        // üß† SLEEP ANALYZER - Advanced sleep pattern analysis
        function showSleepAnalyzer() {
            playSuccessSound();
            const analysis = [
                'üß† ANALYSIS: Your REM cycles are 23% above average - exceptional memory consolidation!',
                'üìä PATTERN: Deep sleep peaks at 2:30 AM - optimal growth hormone release detected!',
                '‚ö° EFFICIENCY: Sleep onset time 8 minutes - faster than 85% of population!',
                'üîç INSIGHT: Your sleep architecture shows signs of high cognitive performance!',
                'üìà TREND: Sleep quality improved 34% over the last 30 days - outstanding progress!'
            ];
            const result = analysis[Math.floor(Math.random() * analysis.length)];
            showNotification(`üß† ANALYZER: ${result}`);
            
            // Update sleep phases visualization
            updateSleepPhasesDisplay();
        }

        // üåÖ CIRCADIAN RHYTHM TRACKER
        function showCircadianTracker() {
            playSuccessSound();
            const circadianData = [
                'üåÖ CIRCADIAN: Your biological clock is perfectly synchronized - optimal melatonin production!',
                '‚è∞ RHYTHM: Body temperature drops at ideal time - circadian alignment at 97%!',
                'üåô TIMING: Natural melatonin surge begins at 9:45 PM - perfect sleep window!',
                '‚òÄÔ∏è LIGHT: Morning light exposure optimal for circadian entrainment!',
                'üîÑ SYNC: Your sleep-wake cycle matches your chronotype perfectly!'
            ];
            const info = circadianData[Math.floor(Math.random() * circadianData.length)];
            showNotification(`üåÖ CIRCADIAN: ${info}`);
            
            // Show circadian recommendations
            updateCircadianRecommendations();
        }

        // ‚ö†Ô∏è SLEEP DEBT TRACKER
        function showSleepDebtTracker() {
            playSuccessSound();
            const currentDebt = calculateSleepDebt();
            const debtInfo = [
                `‚ö†Ô∏è DEBT STATUS: Current sleep debt: ${currentDebt.hours}h ${currentDebt.minutes}m - Action required!`,
                `üìà RECOVERY: At current rate, full recovery in ${currentDebt.recoveryDays} days`,
                `üí° STRATEGY: Add 30 minutes to tonight's sleep to accelerate recovery`,
                `üéØ TARGET: Need 2 consecutive 9-hour nights to eliminate debt completely`,
                `‚ö° IMPACT: Sleep debt reducing cognitive performance by ${currentDebt.impactPercent}%`
            ];
            const info = debtInfo[Math.floor(Math.random() * debtInfo.length)];
            showNotification(`‚ö†Ô∏è SLEEP DEBT: ${info}`);
            
            // Update debt visualization
            updateSleepDebtDisplay(currentDebt);
        }

        // üå°Ô∏è ENVIRONMENT MONITOR
        function showEnvironmentMonitor() {
            playSuccessSound();
            const envData = [
                'üå°Ô∏è ENVIRONMENT: Temperature 68¬∞F, Humidity 45% - PERFECT sleep conditions!',
                'üîá NOISE: Ambient noise 32dB - optimal for deep sleep maintenance!',
                'üí° LIGHT: Room darkness 99.8% - excellent melatonin production environment!',
                'üå¨Ô∏è AIR: Air quality excellent, CO2 levels optimal for sleep!',
                'üì± EMF: Electromagnetic field levels minimal - no sleep disruption detected!'
            ];
            const info = envData[Math.floor(Math.random() * envData.length)];
            showNotification(`üå°Ô∏è ENVIRONMENT: ${info}`);
            
            // Update environment display
            updateEnvironmentDisplay();
        }

        // Advanced sleep debt calculation
        function calculateSleepDebt() {
            const sessions = getSleepSessions();
            const targetSleep = sleepGoal.hours * 60 + sleepGoal.minutes; // in minutes
            let totalDebt = 0;
            
            // Calculate debt over last 7 days
            const lastWeek = sessions.slice(-7);
            lastWeek.forEach(session => {
                const actualSleep = session.duration / (1000 * 60); // convert to minutes
                const debt = Math.max(0, targetSleep - actualSleep);
                totalDebt += debt;
            });
            
            const debtHours = Math.floor(totalDebt / 60);
            const debtMinutes = Math.round(totalDebt % 60);
            const recoveryDays = Math.ceil(totalDebt / (30)); // assuming 30min extra per night
            const impactPercent = Math.min(25, Math.round(totalDebt / 30)); // max 25% impact
            
            return {
                hours: debtHours,
                minutes: debtMinutes,
                recoveryDays: recoveryDays,
                impactPercent: impactPercent,
                totalMinutes: totalDebt
            };
        }

        // Update sleep phases display
        function updateSleepPhasesDisplay() {
            const phases = {
                awake: Math.random() * 10 + 2, // 2-12%
                light: Math.random() * 20 + 40, // 40-60%
                deep: Math.random() * 15 + 15, // 15-30%
                rem: Math.random() * 15 + 15   // 15-30%
            };
            
            // Normalize to 100%
            const total = Object.values(phases).reduce((a, b) => a + b, 0);
            Object.keys(phases).forEach(key => {
                phases[key] = (phases[key] / total) * 100;
            });
            
            // Update the chart
            document.querySelectorAll('.phase-segment').forEach((segment, index) => {
                const phaseNames = ['awake', 'light', 'deep', 'rem'];
                const phaseName = phaseNames[index];
                const percentage = phases[phaseName];
                segment.style.width = `${percentage}%`;
            });
        }

        // Update circadian recommendations
        function updateCircadianRecommendations() {
            const now = new Date();
            const hour = now.getHours();
            let recommendation = '';
            
            if (hour >= 6 && hour < 10) {
                recommendation = '‚òÄÔ∏è Morning: Get bright light exposure for 15-30 minutes to boost alertness';
            } else if (hour >= 10 && hour < 14) {
                recommendation = '‚òï Midday: Avoid caffeine after 2 PM to prevent sleep disruption';
            } else if (hour >= 14 && hour < 18) {
                recommendation = 'üèÉ Afternoon: Ideal time for exercise - boosts nighttime sleep quality';
            } else if (hour >= 18 && hour < 22) {
                recommendation = 'üåÖ Evening: Dim lights and reduce screen time to promote melatonin';
            } else {
                recommendation = 'üåô Night: Your body is producing melatonin - perfect for sleep!';
            }
            
            showNotification(`üåÖ CIRCADIAN TIP: ${recommendation}`);
        }

        // Update sleep debt display
        function updateSleepDebtDisplay(debtData) {
            document.getElementById('sleepDebtValue').textContent = 
                debtData.hours > 0 ? `-${debtData.hours}.${Math.round(debtData.minutes/6)}h` : '0h';
            document.getElementById('recoveryTime').textContent = 
                debtData.recoveryDays > 0 ? `${debtData.recoveryDays} days` : 'None';
            
            // Update progress bar
            const maxDebt = 600; // 10 hours max debt
            const debtPercent = Math.min(100, (debtData.totalMinutes / maxDebt) * 100);
            document.getElementById('debtProgress').style.width = `${100 - debtPercent}%`;
        }

        // Update environment display with simulated sensor data
        function updateEnvironmentDisplay() {
            const envData = {
                temperature: (Math.random() * 6 + 65).toFixed(0), // 65-71¬∞F
                humidity: (Math.random() * 20 + 35).toFixed(0), // 35-55%
                noise: (Math.random() * 20 + 25).toFixed(0), // 25-45dB
                light: Math.random() < 0.8 ? 0 : (Math.random() * 5).toFixed(0) // mostly 0, sometimes 1-5 lux
            };
            
            document.getElementById('roomTemp').textContent = `${envData.temperature}¬∞F`;
            document.getElementById('humidity').textContent = `${envData.humidity}%`;
            document.getElementById('noiseLevel').textContent = `${envData.noise}dB`;
            document.getElementById('lightLevel').textContent = `${envData.light} lux`;
            
            // Update status indicators
            updateEnvironmentStatus(envData);
        }

        // Update environment status indicators
        function updateEnvironmentStatus(data) {
            const indicators = {
                temp: data.temperature >= 65 && data.temperature <= 70,
                humidity: data.humidity >= 40 && data.humidity <= 50,
                noise: data.noise <= 35,
                light: data.light <= 2
            };
            
            // Update trend indicators
            const trends = document.querySelectorAll('#environmentCard .metric-trend');
            const statuses = ['Optimal ‚úÖ', 'Good ‚úÖ', 'Quiet ‚úÖ', 'Dark ‚úÖ'];
            
            trends.forEach((trend, index) => {
                const keys = Object.keys(indicators);
                if (indicators[keys[index]]) {
                    trend.textContent = statuses[index];
                    trend.className = 'metric-trend up';
                } else {
                    trend.textContent = 'Adjust ‚ö†Ô∏è';
                    trend.className = 'metric-trend down';
                }
            });
        }

        // Smart sleep recommendations based on current time and data
        function generateSmartRecommendations() {
            const now = new Date();
            const hour = now.getHours();
            const recommendations = [];
            
            if (hour >= 20 && hour <= 23) {
                recommendations.push({
                    icon: 'üåô',
                    text: `Optimal bedtime in ${23 - hour} hours for 8-hour sleep`,
                    type: 'active'
                });
            }
            
            if (hour >= 18) {
                recommendations.push({
                    icon: 'üì±',
                    text: 'Activate blue light filter on all devices',
                    type: 'reminder'
                });
            }
            
            recommendations.push({
                icon: 'üå°Ô∏è',
                text: 'Keep room temperature between 65-68¬∞F',
                type: 'tip'
            });
            
            return recommendations;
        }

        // Initialize advanced features
        function initAdvancedFeatures() {
            // Update environment display periodically
            updateEnvironmentDisplay();
            setInterval(updateEnvironmentDisplay, 60000); // Update every minute
            
            // Update sleep debt display
            const debtData = calculateSleepDebt();
            updateSleepDebtDisplay(debtData);
            
            // Generate and display smart recommendations
            const recommendations = generateSmartRecommendations();
            updateRecommendationsDisplay(recommendations);
            
            // Update sleep phases display
            updateSleepPhasesDisplay();
        }

        // Update recommendations display
        function updateRecommendationsDisplay(recommendations) {
            const container = document.getElementById('recommendationsList');
            if (!container) return;
            
            container.innerHTML = recommendations.map(rec => `
                <div class="quality-item">
                    <span class="quality-emoji">${rec.icon}</span>
                    <span class="quality-text">${rec.text}</span>
                    <span class="quality-score ${rec.type === 'active' ? 'good' : rec.type === 'reminder' ? 'fair' : 'excellent'}">
                        ${rec.type === 'active' ? 'Active' : rec.type === 'reminder' ? 'Reminder' : 'Tip'}
                    </span>
                </div>
            `).join('');
        }
    </script>
</body>
</html>
